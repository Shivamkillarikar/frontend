<!-- <!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>BMC Complaint Portal</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{--accent:#0b72ff;--muted:#f4f6f8;--danger:#d9534f}
    body{font-family:Inter,Segoe UI,Arial,sans-serif;background:#f7fafc;color:#111;margin:0;padding:24px;display:flex;justify-content:center}
    .card{width:100%;max-width:760px;background:white;border-radius:10px;box-shadow:0 6px 20px rgba(20,20,40,0.08);padding:20px}
    h1{margin:0 0 8px;font-size:20px}
    p.lead{margin:0 0 18px;color:#555}
    form .row{display:flex;gap:12px}
    label{display:block;font-size:13px;margin-bottom:6px;color:#333}
    input[type="text"],input[type="email"],textarea{width:100%;padding:10px;border:1px solid #e3e8ee;border-radius:6px;font-size:14px;box-sizing:border-box}
    textarea{min-height:110px;resize:vertical}
    .controls{display:flex;gap:12px;align-items:center}
    .btn{background:var(--accent);color:white;padding:10px 16px;border-radius:8px;border:none;cursor:pointer;font-weight:600}
    .btn:disabled{opacity:.6;cursor:not-allowed}
    .secondary{background:#eef3ff;color:#053; padding:8px 12px;border-radius:8px;border:1px solid #dbe9ff}
    .resp{margin-top:18px;padding:12px;background:var(--muted);border-radius:8px;white-space:pre-wrap}
    .small{font-size:13px;color:#666}
    .preview{margin-top:8px;display:flex;gap:8px;align-items:center}
    .preview img{max-width:160px;max-height:120px;border-radius:6px;object-fit:cover;border:1px solid #e6e6e6}
    .error{color:var(--danger);font-weight:600}
    .success{color:green;font-weight:600}
  </style>
</head>
<body>
  <div class="card">
    <h1>üèôÔ∏è BMC Complaint Portal</h1>
    <p class="lead">Report civic issues to the Brihanmumbai Municipal Corporation. Attach a photo for proof (optional).</p>

    <form id="complaintForm">
      <div style="display:grid;gap:12px">
        <div>
          <label for="name">Your Name</label>
          <input id="name" name="name" type="text" placeholder="Shivam Killarikar" required />
        </div>

        <div>
          <label for="email">Your Email</label>
          <input id="email" name="email" type="email" placeholder="you@example.com" required />
        </div>

        <div>
          <label for="location">Location</label>
          <input id="location" name="location" type="text" placeholder="Mahim Railway Station, Mumbai" required/>
        </div>

        <div>
          <label for="complaint">Describe the issue</label>
          <textarea id="complaint" name="complaint" placeholder="Garbage accumulated near Mithi River, causing smell..." required></textarea>
        </div>

        <div>
          <label for="image">Upload photo (optional)</label>
          <input id="image" name="image" type="file" accept="image/*" />
          <div class="preview" id="preview" style="display:none">
            <img id="previewImg" src="#" alt="preview" />
            <div>
              <div id="previewName" class="small"></div>
              <button id="removeImage" type="button" class="secondary" style="margin-top:6px">Remove</button>
            </div>
          </div>
        </div>

        <div class="controls">
          <button id="submitBtn" class="btn" type="submit">Send Report</button>
          <div id="status" class="small" aria-live="polite"></div>
        </div>

        <div id="response" class="resp" style="display:none"></div>
      </div>
    </form>
  </div>

<script>
(() => {
  // Set backend URL here:
  const BACKEND_URL = "https://fastapi-backend-t2e9.onrender.com/send-report";

  const form = document.getElementById('complaintForm');
  const imageInput = document.getElementById('image');
  const preview = document.getElementById('preview');
  const previewImg = document.getElementById('previewImg');
  const previewName = document.getElementById('previewName');
  const removeBtn = document.getElementById('removeImage');
  const status = document.getElementById('status');
  const responseBox = document.getElementById('response');
  const submitBtn = document.getElementById('submitBtn');

  let selectedFile = null;

  imageInput.addEventListener('change', (e) => {
    const f = e.target.files && e.target.files[0];
    if (!f) {
      clearPreview();
      return;
    }
    selectedFile = f;
    previewImg.src = URL.createObjectURL(f);
    previewName.textContent = f.name + " ‚Äî " + Math.round(f.size/1024) + " KB";
    preview.style.display = 'flex';
  });

  removeBtn.addEventListener('click', () => {
    imageInput.value = "";
    clearPreview();
  });

  function clearPreview(){
    selectedFile = null;
    previewImg.src = "";
    previewName.textContent = "";
    preview.style.display = 'none';
  }

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    responseBox.style.display = 'none';
    status.textContent = "";
    submitBtn.disabled = true;
    submitBtn.textContent = "Sending...";

    try {
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const location = document.getElementById('location').value.trim();
      const complaint = document.getElementById('complaint').value.trim();

      if (!name || !email || !location || !complaint) {
        status.textContent = "Please fill all required fields.";
        submitBtn.disabled = false;
        submitBtn.textContent = "Send Report";
        return;
      }

      const formData = new FormData();
      formData.append('name', name);
      formData.append('email', email);
      formData.append('location', location);
      formData.append('complaint', complaint);
      // Only append image if a file is selected
      if (selectedFile) formData.append('image', selectedFile);

      status.textContent = "Contacting server...";
      const res = await fetch(BACKEND_URL, {
        method: 'POST',
        body: formData
      });

      let data;
      try {
        data = await res.json();
      } catch (err) {
        throw new Error('Invalid JSON response from server. HTTP ' + res.status);
      }

      if (res.ok && data.status === "success") {
        responseBox.style.display = 'block';
        responseBox.innerHTML = `<div class="success">‚úÖ Email sent successfully</div>\n\n${escapeHtml(data.email_body || '')}`;
        // reset form
        form.reset();
        clearPreview();
      } else {
        responseBox.style.display = 'block';
        responseBox.innerHTML = `<div class="error">‚ö†Ô∏è Failed: ${escapeHtml(data.message || 'Server error')}</div>\n\n${escapeHtml(data.email_body || '')}`;
      }

    } catch (err) {
      responseBox.style.display = 'block';
      responseBox.innerHTML = `<div class="error">Network or server error: ${escapeHtml(err.message)}</div>`;
    } finally {
      submitBtn.disabled = false;
      submitBtn.textContent = "Send Report";
      status.textContent = "";
    }
  });

  function escapeHtml(s = '') {
    return s.replace(/[&<>"'`]/g, (c) => ({
      '&': '&amp;','<': '&lt;','>': '&gt;','"': '&quot;', "'": '&#39;', '`':'&#96;'
    })[c]);
  }
})();
</script>
</body>
</html> -->



<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Civic Helping Agent</title>
<style>
/* ---------- Base ---------- */
*{box-sizing:border-box}
body{
  font-family:"Poppins",sans-serif;
  background:linear-gradient(135deg,#cbe7ff 0%,#eff6ff 50%,#e0f7f6 100%);
  margin:0;padding:0;
  display:flex;flex-direction:column;align-items:center;
  min-height:100vh;
  color:#222;
}
header{
  background:linear-gradient(135deg,#007bff 0%,#00d4ff 100%);
  color:white;text-align:center;
  width:100%;padding:40px 20px;
  box-shadow:0 4px 15px rgba(0,0,0,0.15);
}
header h1{margin:0;font-size:2rem;font-weight:700;letter-spacing:.5px;}
header p{margin:8px 0 0;font-size:1rem;opacity:.9;}

/* ---------- Card ---------- */
.card{
  background:rgba(255,255,255,0.9);
  backdrop-filter:blur(6px);
  border-radius:18px;
  margin-top:-30px;
  box-shadow:0 8px 25px rgba(0,0,0,0.1);
  width:90%;max-width:700px;
  padding:24px 28px 30px;
  animation:fadeIn .8s ease;
}
@keyframes fadeIn{
  from{opacity:0;transform:translateY(10px)}
  to{opacity:1;transform:translateY(0)}
}

/* ---------- Inputs ---------- */
form{display:grid;gap:18px;}
label{font-weight:500;font-size:.95rem;margin-bottom:4px;display:block;}
input,textarea{
  width:100%;padding:10px 12px;
  border:1px solid #d3dce6;border-radius:10px;
  font-size:1rem;transition:.2s;border-bottom:2px solid transparent;
  background:#fdfdfd;
}
input:focus,textarea:focus{
  outline:none;border-color:#007bff;border-bottom-color:#007bff;
  box-shadow:0 0 0 2px rgba(0,123,255,0.1);
}
textarea{min-height:110px;resize:vertical;}

/* ---------- File Upload ---------- */
input[type="file"]{
  border:none;background:none;padding:0;
}
.preview{margin-top:6px;display:flex;gap:10px;align-items:center;animation:fadeIn .3s ease}
.preview img{
  width:120px;height:90px;object-fit:cover;border-radius:10px;border:1px solid #ddd;
}
.secondary{
  background:#f1f3f5;color:#333;
  padding:6px 10px;border:none;border-radius:8px;cursor:pointer;font-size:.9rem;
  transition:.2s;
}
.secondary:hover{background:#e2e8f0;}

/* ---------- Buttons ---------- */
.btn{
  background:linear-gradient(135deg,#007bff 0%,#00b4d8 100%);
  color:white;border:none;
  border-radius:12px;
  padding:12px 20px;
  font-size:1rem;font-weight:600;
  cursor:pointer;
  transition:all .25s ease;
  display:inline-flex;align-items:center;gap:8px;
}
.btn:hover{transform:translateY(-1px);box-shadow:0 4px 10px rgba(0,0,0,0.2);}
.btn:disabled{opacity:.7;cursor:not-allowed}

/* ---------- Response ---------- */
.resp{
  margin-top:18px;padding:14px;
  border-radius:12px;line-height:1.5;
  animation:fadeIn .3s ease;
}
.success{background:#e6ffed;border-left:5px solid #27ae60;color:#1d703f;}
.error{background:#ffe8e8;border-left:5px solid #e74c3c;color:#8c2c21;}
.small{font-size:.9rem;color:#555;}

/* ---------- Spinner ---------- */
.spinner{
  width:16px;height:16px;border:2px solid rgba(255,255,255,0.6);
  border-top-color:#fff;border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

@media(max-width:480px){
  header h1{font-size:1.6rem;}
  .card{padding:20px;}
}
</style>
</head>
<body>

<header>
  <h1>üèôÔ∏è Cic Helping Portal</h1>
  <p>Report civic issues ‚Äî clean, quick & effective</p>
</header>

<div class="card">
  <form id="complaintForm">
    <div>
      <label for="name">Full Name</label>
      <input id="name" name="name" type="text" placeholder="Shivam Killarikar" required>
    </div>

    <div>
      <label for="email">Email</label>
      <input id="email" name="email" type="email" placeholder="you@example.com" required>
    </div>

    <div>
      <label for="location">Location</label>
      <input id="location" name="location" type="text" placeholder="Thane West" required>
    </div>

    <div>
      <label for="complaint">Describe your complaint</label>
      <textarea id="complaint" name="complaint" placeholder="Potholes on MG Road causing traffic..." required></textarea>
    </div>

    <div>
      <label for="image">Attach image (optional)</label>
      <input id="image" type="file" accept="image/*">
      <div class="preview" id="preview" style="display:none">
        <img id="previewImg" src="#" alt="Preview">
        <button type="button" class="secondary" id="removeImage">Remove</button>
      </div>
    </div>

    <button id="submitBtn" class="btn" type="submit">
      <span id="btnText">Submit Report</span>
      <div class="spinner" id="spinner" style="display:none"></div>
    </button>
  </form>

  <div id="response" class="resp" style="display:none"></div>
</div>

<script>
const BACKEND_URL = "https://fastapi-backend-t2e9.onrender.com/send-report";

const form = document.getElementById('complaintForm');
const preview = document.getElementById('preview');
const previewImg = document.getElementById('previewImg');
const removeBtn = document.getElementById('removeImage');
const submitBtn = document.getElementById('submitBtn');
const spinner = document.getElementById('spinner');
const btnText = document.getElementById('btnText');
const responseBox = document.getElementById('response');
let selectedFile = null;

document.getElementById('image').addEventListener('change', (e)=>{
  const f = e.target.files[0];
  if (!f) return;
  selectedFile = f;
  previewImg.src = URL.createObjectURL(f);
  preview.style.display='flex';
});
removeBtn.addEventListener('click', ()=>{
  document.getElementById('image').value="";
  selectedFile=null;
  preview.style.display='none';
});

form.addEventListener('submit', async (e)=>{
  e.preventDefault();
  spinner.style.display='inline-block';
  btnText.textContent='Sending...';
  submitBtn.disabled=true;
  responseBox.style.display='none';

  const fd = new FormData();
  ['name','email','location','complaint'].forEach(id=>{
    fd.append(id, document.getElementById(id).value.trim());
  });
  if(selectedFile) fd.append('image', selectedFile);

  try{
    const res = await fetch(BACKEND_URL,{method:'POST',body:fd});
    const data = await res.json();
    responseBox.style.display='block';
    if(res.ok && data.status==='success'){
      responseBox.className='resp success';
      responseBox.textContent="‚úÖ Report sent successfully!";
      form.reset(); preview.style.display='none';
    } else {
      responseBox.className='resp error';
      responseBox.textContent="‚ö†Ô∏è Failed: "+(data.message||'Server error');
    }
  }catch(err){
    responseBox.style.display='block';
    responseBox.className='resp error';
    responseBox.textContent="üö® Network error: "+err.message;
  }finally{
    spinner.style.display='none';
    btnText.textContent='Submit Report';
    submitBtn.disabled=false;
  }
});
</script>

</body>
</html>


